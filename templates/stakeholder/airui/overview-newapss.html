{% extends "includes/dashboard-base.html" %}
{% load static %}
{% block content %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="air__layout__content">
  <div class="air__utils__content" style="padding-bottom:0">
    <h5><strong>Overview Dashboard</strong></h5>
    <div class="row">
        {% for i in data_string %}
        <div class="col-sm-3 my-3">
            <div class="card-header" style="background-color:#249ce4; color:#FFFF; ">
                <strong>{{i.params}}</strong>
                <div class="row align-items-center justify-content-center">
                    <p class="font-size-50">{{i.total}}k</p>
                    <p class="mx-3" style="border-left: 2px solid #bdbdbd; height: 54px;">
                    <div class="text-center">
                        {% if i.trend == "#66bb6a" %}
                            <i class="fa fa-arrow-up" style="color:{{i.trend}}" aria-hidden="true"></i>
                        {% elif i.trend == "#ef5350" %}
                            <i class="fa fa-arrow-down" style="color:{{i.trend}}" aria-hidden="true"></i>
                        {% endif %}
                        <p>{{i.percentage}}%</p>
                    </div>
                </div>
            </div> 
        </div>
        {% endfor %}
    </div>

    <div class="container mt-5 overflow-hidden">
      <div class="row justify-content-around">
        {% for data_title in title %}
        <div class="card col-md-6" style="max-width:470px">
            <div class="card-body">
                <h5 class="card-title">{{data_title}}</h5>
                <div>
                    {% if forloop.counter0 == 0 %}
                    <canvas id="engagement"></canvas>
                    {% elif forloop.counter0 == 1 %}
                    <canvas id="follower"></canvas>
                    {% elif forloop.counter0 == 2 %}
                    <canvas id="reach"></canvas>
                    {% elif forloop.counter0 == 3 %}
                    <canvas id="talk"></canvas>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
<script>
    {% comment %} engagement {% endcomment %}
    var dataChart = JSON.parse("{{data_chart|escapejs}}");
    const labels = [1,2,3,4,5,6];
    const data_engagement = {
        labels: labels,
        datasets: [
        {
            label: 'Like',
            backgroundColor: '#249ce4',
            borderColor: '#249ce4',
            data: dataChart[0].like,
        },
        {
            label: 'Share',
            backgroundColor: '#66bb6a',
            borderColor: '#66bb6a',
            data: dataChart[0].share,
        },
        {
            label: 'Talk',
            backgroundColor: '#FFFF00',
            borderColor: '#FFFF00',
            data: dataChart[0].talk,
        }]
    };
    const data_follower = {
        labels: labels,
        datasets: [
        {
            label: 'Facebook',
            backgroundColor: '#249ce4',
            borderColor: '#249ce4',
            data: dataChart[1].facebook,
        },
        {
            label: 'Twitter',
            backgroundColor: '#66bb6a',
            borderColor: '#66bb6a',
            data: dataChart[1].twitter,
        },
        {
            label: 'Instagram',
            backgroundColor: '#FFFF00',
            borderColor: '#FFFF00',
            data: dataChart[1].instagram,
        },
        {
            label: 'Youtube',
            backgroundColor: '#fc0313',
            borderColor: '#fc0313',
            data: dataChart[1].youtube,
        }]
    };
    const data_reach = {
        labels: labels,
        datasets: [
        {
            label: 'Reach',
            backgroundColor: '#249ce4',
            borderColor: '#249ce4',
            data: dataChart[2].reach,
        },
        {
            label: 'Impression',
            backgroundColor: '#fc0313',
            borderColor: '#fc0313',
            data: dataChart[2].impression,
        }]
    };
    const data_talk = {
        labels: labels,
        datasets: [
        {
            label: 'Talk',
            backgroundColor: '#249ce4',
            borderColor: '#249ce4',
            data: dataChart[3].talk,
        },
        {
            label: 'Talker',
            backgroundColor: '#fc0313',
            borderColor: '#fc0313',
            data: dataChart[3].talker,
        }]
    };

    const config_engagement = {
        type: 'line',
        data: data_engagement,
        options: {}
    };
    const config_follower = {
        type: 'line',
        data: data_follower,
        options: {}
    };
    const config_reach = {
        type: 'line',
        data: data_reach,
        options: {}
    };
    const config_talk = {
        type: 'line',
        data: data_talk,
        options: {}
    };

    const chartEngagement = new Chart(
        document.getElementById('engagement'),
        config_engagement
    );
    const chartFollower = new Chart(
        document.getElementById('follower'),
        config_follower
    );
    const chartReach = new Chart(
        document.getElementById('reach'),
        config_reach
    );
    const chartTalk = new Chart(
        document.getElementById('talk'),
        config_talk
    );
</script>

{% endblock content %}